version: '{build}'
image: Visual Studio 2017
build:
  verbosity: minimal
services:
  - mongodb
install:
  - choco install opencover codecov


build_script:
  - dotnet build
test_script:
  - OpenCover.Console.exe -register:user -target:"C:\Program Files\dotnet\dotnet.exe" -targetargs:"test" -filter:"+[MongoFramework]* -[MongoFramework.Tests]*" -output:".\coverage.xml"
  - codecov -f coverage.xml


artifacts:
  - path: 'MongoFramework\bin\Debug\*.nupkg'
    name: NuGet Package

  - path: coverage.xml
    name: Coverage Report