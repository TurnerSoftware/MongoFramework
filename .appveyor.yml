- 
  version: '{build}'
  image: Visual Studio 2017
  skip_tags: true
  branches:
    only:
      - master
  skip_commits:
    files:
    - '**/*.md'

  services:
    - mongodb
  install:
    - choco install opencover codecov
    - ps: .\build\dotnet-install.ps1 -Version 3.0.100-preview5-011568

  build_script:
    - ps: .\build.ps1 -CheckCoverage true

  test: false
  artifacts:
    - path: '.\build-artifacts\*'


- 
  version: '{APPVEYOR_REPO_TAG_NAME}+{build}'
  image: Visual Studio 2017
  skip_non_tags: true
  branches:
    only:
      - master

  services:
    - mongodb
  install:
    - choco install opencover codecov
    - ps: .\build\dotnet-install.ps1 -Version 3.0.100-preview5-011568

  build_script:
    - ps: .\build.ps1 -CreatePackages true

  test: false
  artifacts:
    - path: '.\build-artifacts\*'